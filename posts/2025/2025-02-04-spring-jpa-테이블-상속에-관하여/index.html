<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>[Spring JPA] 테이블 상속에 관하여 | blog.blu3fishez</title>
<meta name="keywords" content="Spring">
<meta name="description" content="Porring 백엔드를 구현하면서, OAuth 혹은 네이티브 로그인 계정에 대한 ERD 타입을 슈퍼타입과 서브타입으로 정의하였다.
데이터베이스 상으로만 봤지만, 실제로 어떻게 구현을 해야할까? 단순 쿼리를 한다면 되겠지만, 복잡한 작업이 될 것이며, 쿼리 중간에 예상치 못한 버그가 있을 수 있다. JPA 에서는 어떻게 되는지 알아보자!

@Inheritance 로 상속하기
다들 알겠지만, ERD 에서 슈퍼타입과 서브타입은 일종의 상속 관계 이다.
JPA에서의 상속은 @Inheritance 로 구현될 수 있다.

// SINGLE_TABLE 전략
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
public abstract class Item {
    @Id @GeneratedValue
    private Long id;
    private String name;
}


// JOINED 전략 - @DiscriminatorColumn 선택사항
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public abstract class Vehicle {
    @Id @GeneratedValue
    private Long id;
}

@Entity
public class Car extends Vehicle {
    private String model;
}

// TABLE_PER_CLASS 전략 - 자바에서 상속 관계 유지
@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public abstract class Payment {
    @Id @GeneratedValue
    private Long id;
}

@Entity
public class CardPayment extends Payment {
    private String cardNumber;
}
일반적인 JoinedColumn 등과의 차이점은, PK 값을 공유한다는 점이다.">
<meta name="author" content="blu3fishez">
<link rel="canonical" href="https://blog.blu3fishez.org/posts/2025/2025-02-04-spring-jpa-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%83%81%EC%86%8D%EC%97%90-%EA%B4%80%ED%95%98%EC%97%AC/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.580d5c4b37c6350e62c76a9e39ccff4785bf5e515b18b3cb0605dea4cc5f5376.css" integrity="sha256-WA1cSzfGNQ5ix2qeOcz/R4W/XlFbGLPLBgXepMxfU3Y=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.blu3fishez.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.blu3fishez.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.blu3fishez.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.blu3fishez.org/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.blu3fishez.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://blog.blu3fishez.org/posts/2025/2025-02-04-spring-jpa-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%83%81%EC%86%8D%EC%97%90-%EA%B4%80%ED%95%98%EC%97%AC/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://blog.blu3fishez.org/posts/2025/2025-02-04-spring-jpa-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%83%81%EC%86%8D%EC%97%90-%EA%B4%80%ED%95%98%EC%97%AC/">
  <meta property="og:site_name" content="blog.blu3fishez">
  <meta property="og:title" content="[Spring JPA] 테이블 상속에 관하여">
  <meta property="og:description" content="Porring 백엔드를 구현하면서, OAuth 혹은 네이티브 로그인 계정에 대한 ERD 타입을 슈퍼타입과 서브타입으로 정의하였다.
데이터베이스 상으로만 봤지만, 실제로 어떻게 구현을 해야할까? 단순 쿼리를 한다면 되겠지만, 복잡한 작업이 될 것이며, 쿼리 중간에 예상치 못한 버그가 있을 수 있다. JPA 에서는 어떻게 되는지 알아보자!
@Inheritance 로 상속하기 다들 알겠지만, ERD 에서 슈퍼타입과 서브타입은 일종의 상속 관계 이다.
JPA에서의 상속은 @Inheritance 로 구현될 수 있다.
// SINGLE_TABLE 전략 @Entity @Inheritance(strategy = InheritanceType.SINGLE_TABLE) public abstract class Item { @Id @GeneratedValue private Long id; private String name; } // JOINED 전략 - @DiscriminatorColumn 선택사항 @Entity @Inheritance(strategy = InheritanceType.JOINED) public abstract class Vehicle { @Id @GeneratedValue private Long id; } @Entity public class Car extends Vehicle { private String model; } // TABLE_PER_CLASS 전략 - 자바에서 상속 관계 유지 @Entity @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS) public abstract class Payment { @Id @GeneratedValue private Long id; } @Entity public class CardPayment extends Payment { private String cardNumber; } 일반적인 JoinedColumn 등과의 차이점은, PK 값을 공유한다는 점이다.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-04T23:30:34+09:00">
    <meta property="article:modified_time" content="2025-02-04T23:30:34+09:00">
    <meta property="article:tag" content="Spring">
      <meta property="og:image" content="https://blog.blu3fishez.org/images/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.blu3fishez.org/images/papermod-cover.png">
<meta name="twitter:title" content="[Spring JPA] 테이블 상속에 관하여">
<meta name="twitter:description" content="Porring 백엔드를 구현하면서, OAuth 혹은 네이티브 로그인 계정에 대한 ERD 타입을 슈퍼타입과 서브타입으로 정의하였다.
데이터베이스 상으로만 봤지만, 실제로 어떻게 구현을 해야할까? 단순 쿼리를 한다면 되겠지만, 복잡한 작업이 될 것이며, 쿼리 중간에 예상치 못한 버그가 있을 수 있다. JPA 에서는 어떻게 되는지 알아보자!

@Inheritance 로 상속하기
다들 알겠지만, ERD 에서 슈퍼타입과 서브타입은 일종의 상속 관계 이다.
JPA에서의 상속은 @Inheritance 로 구현될 수 있다.

// SINGLE_TABLE 전략
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
public abstract class Item {
    @Id @GeneratedValue
    private Long id;
    private String name;
}


// JOINED 전략 - @DiscriminatorColumn 선택사항
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public abstract class Vehicle {
    @Id @GeneratedValue
    private Long id;
}

@Entity
public class Car extends Vehicle {
    private String model;
}

// TABLE_PER_CLASS 전략 - 자바에서 상속 관계 유지
@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public abstract class Payment {
    @Id @GeneratedValue
    private Long id;
}

@Entity
public class CardPayment extends Payment {
    private String cardNumber;
}
일반적인 JoinedColumn 등과의 차이점은, PK 값을 공유한다는 점이다.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.blu3fishez.org/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "[Spring JPA] 테이블 상속에 관하여",
      "item": "https://blog.blu3fishez.org/posts/2025/2025-02-04-spring-jpa-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%83%81%EC%86%8D%EC%97%90-%EA%B4%80%ED%95%98%EC%97%AC/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "[Spring JPA] 테이블 상속에 관하여",
  "name": "[Spring JPA] 테이블 상속에 관하여",
  "description": "Porring 백엔드를 구현하면서, OAuth 혹은 네이티브 로그인 계정에 대한 ERD 타입을 슈퍼타입과 서브타입으로 정의하였다.\n데이터베이스 상으로만 봤지만, 실제로 어떻게 구현을 해야할까? 단순 쿼리를 한다면 되겠지만, 복잡한 작업이 될 것이며, 쿼리 중간에 예상치 못한 버그가 있을 수 있다. JPA 에서는 어떻게 되는지 알아보자!\n@Inheritance 로 상속하기 다들 알겠지만, ERD 에서 슈퍼타입과 서브타입은 일종의 상속 관계 이다.\nJPA에서의 상속은 @Inheritance 로 구현될 수 있다.\n// SINGLE_TABLE 전략 @Entity @Inheritance(strategy = InheritanceType.SINGLE_TABLE) public abstract class Item { @Id @GeneratedValue private Long id; private String name; } // JOINED 전략 - @DiscriminatorColumn 선택사항 @Entity @Inheritance(strategy = InheritanceType.JOINED) public abstract class Vehicle { @Id @GeneratedValue private Long id; } @Entity public class Car extends Vehicle { private String model; } // TABLE_PER_CLASS 전략 - 자바에서 상속 관계 유지 @Entity @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS) public abstract class Payment { @Id @GeneratedValue private Long id; } @Entity public class CardPayment extends Payment { private String cardNumber; } 일반적인 JoinedColumn 등과의 차이점은, PK 값을 공유한다는 점이다.\n",
  "keywords": [
    "Spring"
  ],
  "articleBody": "Porring 백엔드를 구현하면서, OAuth 혹은 네이티브 로그인 계정에 대한 ERD 타입을 슈퍼타입과 서브타입으로 정의하였다.\n데이터베이스 상으로만 봤지만, 실제로 어떻게 구현을 해야할까? 단순 쿼리를 한다면 되겠지만, 복잡한 작업이 될 것이며, 쿼리 중간에 예상치 못한 버그가 있을 수 있다. JPA 에서는 어떻게 되는지 알아보자!\n@Inheritance 로 상속하기 다들 알겠지만, ERD 에서 슈퍼타입과 서브타입은 일종의 상속 관계 이다.\nJPA에서의 상속은 @Inheritance 로 구현될 수 있다.\n// SINGLE_TABLE 전략 @Entity @Inheritance(strategy = InheritanceType.SINGLE_TABLE) public abstract class Item { @Id @GeneratedValue private Long id; private String name; } // JOINED 전략 - @DiscriminatorColumn 선택사항 @Entity @Inheritance(strategy = InheritanceType.JOINED) public abstract class Vehicle { @Id @GeneratedValue private Long id; } @Entity public class Car extends Vehicle { private String model; } // TABLE_PER_CLASS 전략 - 자바에서 상속 관계 유지 @Entity @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS) public abstract class Payment { @Id @GeneratedValue private Long id; } @Entity public class CardPayment extends Payment { private String cardNumber; } 일반적인 JoinedColumn 등과의 차이점은, PK 값을 공유한다는 점이다.\n상속을 통해 PK는 공유할 수 있으며, 코드의 중복을 줄일 수 있는 장점이 있다.\n상속 전략 그렇다면, 실제 데이터베이스에서는 어떻게 구현이 될까?\n그것은 @Inheritance 의 상속 전략에 따라 결정된다.\n@Inheritance 어노테이션의 strategy 속성을 아래와 같이 세가지 방식으로 정할 수 있다.\n1. JOINED JOINED 속성은 특정 자식 타입을 부모와 자식 테이블의 JOIN으로 받아오는 전략이다.\n따라서 데이터의 정합성은 해당 방식이 가장 만족시켜줄 수 있다고 볼 수 있다.\n하지만, JOIN 으로 인한 예기치 못한 성능 저하를 고려해야할 것이다.\n// 부모 테이블 package com.kolown.porring.account; import com.kolown.porring.common.BaseTimeEntity; import jakarta.persistence.*; @Entity @Table(name = \"accounts\") @Inheritance(strategy = InheritanceType.JOINED) @DiscriminatorColumn(name = \"sub_type\") public class Account extends BaseTimeEntity { @Id @GeneratedValue(strategy = GenerationType.AUTO) private Long accountId; } // 자식 테이블(서브타입) package com.kolown.porring.account; import jakarta.persistence.*; @Entity @Table(name = \"email_accounts\") public class EmailAccount extends Account { private String email; private String password; } 실제 테이블 생성은 아래와 같이 되고, 데이터 조회 시 두 테이블이 JOIN 된다.\nCREATE TABLE accounts ( account_id BIGINT PRIMARY KEY, sub_type VARCHAR(31), created_at TIMESTAMP, -- BASETIME ENTITY 로 인한 생성 updated_at TIMESTAMP ); CREATE TABLE email_accounts ( account_id BIGINT PRIMARY KEY, email VARCHAR(255), password VARCHAR(255), FOREIGN KEY (account_id) REFERENCES accounts(account_id) ); 2. TABLE_PER_CLASS 이 방식은 애초부터 부모타입의 테이블은 없으며, 서브타입별로 테이블을 분리하여 보관하는 전략이다.\n그렇기 때문에 앞서 이야기한 방식과는 달리 정합성을 지키지 않는다.\n하지만, 상속 관계를 유지하는 것은 JPA 에게 있기 때문에 실제로 사용할 때에는 JOINED 방식처럼 사용해도 큰 차이가 없다.\n@Entity @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS) public abstract class Vehicle { @Id @GeneratedValue private Long id; private String name; } @Entity public class Car extends Vehicle { private String model; } @Entity public class Airplane extends Vehicle { private String flightNumber; } -- 애초부터 별도의 테이블로 형성된 모습. 하지만 CREATE TABLE car ( id BIGINT PRIMARY KEY, name VARCHAR(255), -- 부모의 컬럼 model VARCHAR(255) -- Car의 컬럼 ); CREATE TABLE airplane ( id BIGINT PRIMARY KEY, name VARCHAR(255), -- 부모의 컬럼 flight_number VARCHAR(255) -- Airplane의 컬럼 ); 3. SINGLE_TABLE 하나의 테이블에 모든 정보를 다 넣는 전략이다.\n조인이 필요 없어서 조회 성능이 빠르나, 자식 엔티티의 컬럼은 모두 null 을 허용해야한다.\n실제로, 코드만 보면 별 차이가 없음을 느낄 것이다.\n@Entity @Inheritance(strategy = InheritanceType.SINGLE_TABLE) @DiscriminatorColumn(name = \"vehicle_type\") public abstract class Vehicle { @Id @GeneratedValue private Long id; private String name; } @Entity @DiscriminatorValue(\"CAR\") public class Car extends Vehicle { private String model; } @Entity @DiscriminatorValue(\"AIRPLANE\") public class Airplane extends Vehicle { private String flightNumber; } 하지만 실제로는 아래와 같이 정의가 된다. 완전 딴판이다.\nCREATE TABLE vehicle ( id BIGINT PRIMARY KEY, dtype VARCHAR(31), model VARCHAR(255), -- Car의 컬럼 flight_number VARCHAR(255), -- Airplane의 컬럼 ); @DiscriminatorColumn Discriminator 란 한국어로 판별자를 뜻한다. 진위를 가리는 무언가를 뜻한다.\n즉, 그렇다면 이렇게 해석할 수 있겠다.\n진위를 가리는 컬럼\n다시 말해 현재 찾아보는 엔티티가 정확히 어떤 타입인지 판별하는 컬럼을 정의하겠다는 의미이다.\n@DiscriminiatorValue 명시적으로 구분자 컬럼을 정의해준다. 부모 테이블의 컬럼 이름이 다르게 매핑하고 싶을 경우 사용하면 된다.\n자세한 예시는 위 SINGLE_TABLE 예시를 살펴보자.\n@DiscriminatorColumn 은 필수인가? 오늘 코드리뷰를 하다가 위 제목과 같은 얘기가 오갔다.\n결론적으로 꼭 그렇지 않지만, @DiscriminatorColumn 을 사용해서 얻을 수 있는 이점은 아래와 같다.\nSINGLE TABLE 사용 시에는 필수 반정규화를 어쩔 수 없이 해야하는 경우, 하나의 테이블 내에서 구분자를 기준으로 JPA가 값을 받아와야하기 때문에, 반정규화를 할 때에는 필수로 지목해주어야한다.\n그 외에는 필수가 아니지만, 구별자를 위해선 명시해두면 좋다.\n명시적으로 어떤 컬럼값으로 연결되는지 확인할 수 있다. 그 다음은 코드의 가독성이 있을 수 있다.\n사실 어떤 테이블이건 간에 관계 에 대한 문제는 관계 유형에 따라 달라진다.\n상속이라는 문제도 1:1 관계 매핑에 해당되는 문제이기 때문이다.\n그렇기에 실제로 판별자를 매번 매핑할 필욘 없겠지만, 우리가 코드를 읽을 때, 아, 이 컬럼을 바탕으로 두 테이블 사이에는 상속 관계가 있구나! 정도는 확인하고 넘어갈 수 있다.\n구분자 컬럼을 정의할 필요가 없다. 구분자 컬럼을 정의할 필요가 없어서 데이터의 무결성을 지키는 데에 도움이 된다.\n이게 무슨 뜻이냐? 만약에 order_id 라는 구분자로 처리되고, 우리는 이를 JPA 에게 상속을 통해 맡기고 싶은 상황이 된다고 해보자.\n이때, 우리는 @DiscriminatorColumn 으로 구분자 컬럼을 정의해주면, 실제 Entity 필드로 해당 컬럼을 정의할 필요가 없어지게 된다. 컬럼의 이름을 넘겨줌으로써 JPA에게 책임이 넘어가기 때문이다.\n그렇기에 해당 필드변수가 Spring Boot 코드 내에서 조작될 일이 없어지므로 해당 연결에 대한 데이터 무결성은 보장된다.\n결론 테이블 JOIN을 하는 경우와 테이블별로 그냥 따로 만들 때에는 DiscriminatorColumn은 필수가 아니며,\nInheritance를 통해 서로 다른 테이블(TABLE_PER_CLASS)인 경우에도 하위타입인 것처럼 자바 코드에서 사용할 수 있다!\n",
  "wordCount" : "838",
  "inLanguage": "en",
  "image": "https://blog.blu3fishez.org/images/papermod-cover.png","datePublished": "2025-02-04T23:30:34+09:00",
  "dateModified": "2025-02-04T23:30:34+09:00",
  "author":{
    "@type": "Person",
    "name": "blu3fishez"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.blu3fishez.org/posts/2025/2025-02-04-spring-jpa-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%83%81%EC%86%8D%EC%97%90-%EA%B4%80%ED%95%98%EC%97%AC/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "blog.blu3fishez",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.blu3fishez.org/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.blu3fishez.org/" accesskey="h" title="blog.blu3fishez (Alt + H)">blog.blu3fishez</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.blu3fishez.org/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://blog.blu3fishez.org/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://blog.blu3fishez.org/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.blu3fishez.org/">Home</a>&nbsp;»&nbsp;<a href="https://blog.blu3fishez.org/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      [Spring JPA] 테이블 상속에 관하여
    </h1>
    <div class="post-meta"><span title='2025-02-04 23:30:34 +0900 KST'>February 4, 2025</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;blu3fishez

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#inheritance-%eb%a1%9c-%ec%83%81%ec%86%8d%ed%95%98%ea%b8%b0" aria-label="@Inheritance 로 상속하기">@Inheritance 로 상속하기</a></li>
                <li>
                    <a href="#%ec%83%81%ec%86%8d-%ec%a0%84%eb%9e%b5" aria-label="상속 전략">상속 전략</a><ul>
                        
                <li>
                    <a href="#1-joined" aria-label="1. JOINED">1. JOINED</a></li>
                <li>
                    <a href="#2-table_per_class" aria-label="2. TABLE_PER_CLASS">2. TABLE_PER_CLASS</a></li>
                <li>
                    <a href="#3-single_table" aria-label="3. SINGLE_TABLE">3. SINGLE_TABLE</a></li></ul>
                </li>
                <li>
                    <a href="#discriminatorcolumn" aria-label="@DiscriminatorColumn">@DiscriminatorColumn</a><ul>
                        
                <li>
                    <a href="#discriminiatorvalue" aria-label="@DiscriminiatorValue">@DiscriminiatorValue</a></li></ul>
                </li>
                <li>
                    <a href="#discriminatorcolumn-%ec%9d%80-%ed%95%84%ec%88%98%ec%9d%b8%ea%b0%80" aria-label="@DiscriminatorColumn 은 필수인가?">@DiscriminatorColumn 은 필수인가?</a><ul>
                        
                <li>
                    <a href="#single-table-%ec%82%ac%ec%9a%a9-%ec%8b%9c%ec%97%90%eb%8a%94-%ed%95%84%ec%88%98" aria-label="SINGLE TABLE 사용 시에는 필수">SINGLE TABLE 사용 시에는 필수</a></li>
                <li>
                    <a href="#%eb%aa%85%ec%8b%9c%ec%a0%81%ec%9c%bc%eb%a1%9c-%ec%96%b4%eb%96%a4-%ec%bb%ac%eb%9f%bc%ea%b0%92%ec%9c%bc%eb%a1%9c-%ec%97%b0%ea%b2%b0%eb%90%98%eb%8a%94%ec%a7%80-%ed%99%95%ec%9d%b8%ed%95%a0-%ec%88%98-%ec%9e%88%eb%8b%a4" aria-label="명시적으로 어떤 컬럼값으로 연결되는지 확인할 수 있다.">명시적으로 어떤 컬럼값으로 연결되는지 확인할 수 있다.</a></li>
                <li>
                    <a href="#%ea%b5%ac%eb%b6%84%ec%9e%90-%ec%bb%ac%eb%9f%bc%ec%9d%84-%ec%a0%95%ec%9d%98%ed%95%a0-%ed%95%84%ec%9a%94%ea%b0%80-%ec%97%86%eb%8b%a4" aria-label="구분자 컬럼을 정의할 필요가 없다.">구분자 컬럼을 정의할 필요가 없다.</a></li>
                <li>
                    <a href="#%ea%b2%b0%eb%a1%a0" aria-label="결론">결론</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>
<div class="post-content"><p><code>Porring</code> 백엔드를 구현하면서, <code>OAuth</code> 혹은 네이티브 로그인 계정에 대한 ERD 타입을 <a href="https://blog.moozeh.org/posts/erd-%EC%8A%88%ED%8D%BC%ED%83%80%EC%9E%85-%EC%84%9C%EB%B8%8C%ED%83%80%EC%9E%85%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90">슈퍼타입과 서브타입</a>으로 정의하였다.</p>
<p>데이터베이스 상으로만 봤지만, 실제로 어떻게 구현을 해야할까? 단순 쿼리를 한다면 되겠지만, 복잡한 작업이 될 것이며, 쿼리 중간에 예상치 못한 버그가 있을 수 있다. <code>JPA</code> 에서는 어떻게 되는지 알아보자!</p>
<!-- more -->
<h2 id="inheritance-로-상속하기">@Inheritance 로 상속하기<a hidden class="anchor" aria-hidden="true" href="#inheritance-로-상속하기">#</a></h2>
<p>다들 알겠지만, ERD 에서 슈퍼타입과 서브타입은 일종의 <code>상속 관계</code> 이다.</p>
<p>JPA에서의 상속은 <code>@Inheritance</code> 로 구현될 수 있다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// SINGLE_TABLE 전략</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Inheritance</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InheritanceType</span><span class="p">.</span><span class="na">SINGLE_TABLE</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Item</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Id</span><span class="w"> </span><span class="nd">@GeneratedValue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// JOINED 전략 - @DiscriminatorColumn 선택사항</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Inheritance</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InheritanceType</span><span class="p">.</span><span class="na">JOINED</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Id</span><span class="w"> </span><span class="nd">@GeneratedValue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Car</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// TABLE_PER_CLASS 전략 - 자바에서 상속 관계 유지</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Inheritance</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InheritanceType</span><span class="p">.</span><span class="na">TABLE_PER_CLASS</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Payment</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Id</span><span class="w"> </span><span class="nd">@GeneratedValue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CardPayment</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Payment</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">cardNumber</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>일반적인 <code>JoinedColumn</code> 등과의 차이점은, <code>PK</code> 값을 공유한다는 점이다.</p>
<p>상속을 통해 PK는 공유할 수 있으며, 코드의 중복을 줄일 수 있는 장점이 있다.</p>
<h2 id="상속-전략">상속 전략<a hidden class="anchor" aria-hidden="true" href="#상속-전략">#</a></h2>
<p>그렇다면, <strong>실제 데이터베이스에서는 어떻게 구현이 될까?</strong></p>
<p>그것은 <code>@Inheritance</code> 의 상속 전략에 따라 결정된다.</p>
<p><code>@Inheritance</code> 어노테이션의 <code>strategy</code> 속성을 아래와 같이 세가지 방식으로 정할 수 있다.</p>
<h3 id="1-joined">1. JOINED<a hidden class="anchor" aria-hidden="true" href="#1-joined">#</a></h3>
<p><code>JOINED</code> 속성은 <strong>특정 자식 타입을 부모와 자식 테이블의 JOIN으로 받아오는 전략이다.</strong></p>
<p>따라서 데이터의 정합성은 해당 방식이 가장 만족시켜줄 수 있다고 볼 수 있다.</p>
<p>하지만, JOIN 으로 인한 예기치 못한 성능 저하를 고려해야할 것이다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 부모 테이블</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">package</span><span class="w"> </span><span class="nn">com.kolown.porring.account</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">com.kolown.porring.common.BaseTimeEntity</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.persistence.*</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;accounts&#34;</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Inheritance</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InheritanceType</span><span class="p">.</span><span class="na">JOINED</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@DiscriminatorColumn</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;sub_type&#34;</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Account</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseTimeEntity</span><span class="w"> </span><span class="p">{</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Id</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerationType</span><span class="p">.</span><span class="na">AUTO</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">accountId</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// 자식 테이블(서브타입)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">package</span><span class="w"> </span><span class="nn">com.kolown.porring.account</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.persistence.*</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;email_accounts&#34;</span><span class="p">)</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EmailAccount</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Account</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">;</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>실제 테이블 생성은 아래와 같이 되고, 데이터 조회 시 두 테이블이 <code>JOIN</code> 된다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">account_id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sub_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span><span class="w"> </span><span class="c1">-- BASETIME ENTITY 로 인한 생성
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">email_accounts</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">account_id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">password</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">account_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">accounts</span><span class="p">(</span><span class="n">account_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-table_per_class">2. TABLE_PER_CLASS<a hidden class="anchor" aria-hidden="true" href="#2-table_per_class">#</a></h3>
<p>이 방식은 애초부터 <strong>부모타입의 테이블은 없으며, 서브타입별로 테이블을 분리하여 보관하는 전략이다.</strong></p>
<p>그렇기 때문에 앞서 이야기한 방식과는 달리 정합성을 지키지 않는다.</p>
<p>하지만, 상속 관계를 유지하는 것은 JPA 에게 있기 때문에 실제로 사용할 때에는 JOINED 방식처럼 사용해도 큰 차이가 없다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Inheritance</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InheritanceType</span><span class="p">.</span><span class="na">TABLE_PER_CLASS</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Id</span><span class="w"> </span><span class="nd">@GeneratedValue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Car</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Airplane</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">flightNumber</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 애초부터 별도의 테이블로 형성된 모습. 하지만
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">  </span><span class="c1">-- 부모의 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">model</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w">  </span><span class="c1">-- Car의 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">airplane</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">  </span><span class="c1">-- 부모의 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">flight_number</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w">  </span><span class="c1">-- Airplane의 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-single_table">3. SINGLE_TABLE<a hidden class="anchor" aria-hidden="true" href="#3-single_table">#</a></h3>
<p>하나의 테이블에 모든 정보를 다 넣는 전략이다.</p>
<p>조인이 필요 없어서 조회 성능이 빠르나, <strong>자식 엔티티의 컬럼은 모두 null 을 허용해야한다.</strong></p>
<p>실제로, 코드만 보면 별 차이가 없음을 느낄 것이다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Inheritance</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InheritanceType</span><span class="p">.</span><span class="na">SINGLE_TABLE</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@DiscriminatorColumn</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;vehicle_type&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Id</span><span class="w"> </span><span class="nd">@GeneratedValue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@DiscriminatorValue</span><span class="p">(</span><span class="s">&#34;CAR&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Car</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@DiscriminatorValue</span><span class="p">(</span><span class="s">&#34;AIRPLANE&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Airplane</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">flightNumber</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>하지만 실제로는 아래와 같이 정의가 된다. 완전 딴판이다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">vehicle</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">dtype</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">model</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">  </span><span class="c1">-- Car의 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">flight_number</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">  </span><span class="c1">-- Airplane의 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="discriminatorcolumn">@DiscriminatorColumn<a hidden class="anchor" aria-hidden="true" href="#discriminatorcolumn">#</a></h2>
<p>Discriminator 란 한국어로 판별자를 뜻한다. 진위를 가리는 무언가를 뜻한다.</p>
<p>즉,  그렇다면 이렇게 해석할 수 있겠다.</p>
<blockquote>
<p>진위를 가리는 컬럼</p></blockquote>
<p>다시 말해 현재 찾아보는 엔티티가 정확히 <strong>어떤 타입인지 판별하는 컬럼을 정의하겠다는 의미이다.</strong></p>
<h3 id="discriminiatorvalue">@DiscriminiatorValue<a hidden class="anchor" aria-hidden="true" href="#discriminiatorvalue">#</a></h3>
<p>명시적으로 구분자 컬럼을 정의해준다. 부모 테이블의 컬럼 이름이 다르게 매핑하고 싶을 경우 사용하면 된다.</p>
<p>자세한 예시는 위 <code>SINGLE_TABLE</code> 예시를 살펴보자.</p>
<h2 id="discriminatorcolumn-은-필수인가">@DiscriminatorColumn 은 필수인가?<a hidden class="anchor" aria-hidden="true" href="#discriminatorcolumn-은-필수인가">#</a></h2>
<p>오늘 코드리뷰를 하다가 위 제목과 같은 얘기가 오갔다.</p>
<p>결론적으로 꼭 그렇지 않지만, @DiscriminatorColumn 을 사용해서 얻을 수 있는 이점은 아래와 같다.</p>
<h3 id="single-table-사용-시에는-필수">SINGLE TABLE 사용 시에는 필수<a hidden class="anchor" aria-hidden="true" href="#single-table-사용-시에는-필수">#</a></h3>
<p>반정규화를 어쩔 수 없이 해야하는 경우, 하나의 테이블 내에서 구분자를 기준으로 JPA가 값을 받아와야하기 때문에, <strong>반정규화를 할 때에는 필수로 지목해주어야한다.</strong></p>
<p>그 외에는 필수가 아니지만, 구별자를 위해선 명시해두면 좋다.</p>
<h3 id="명시적으로-어떤-컬럼값으로-연결되는지-확인할-수-있다">명시적으로 어떤 컬럼값으로 연결되는지 확인할 수 있다.<a hidden class="anchor" aria-hidden="true" href="#명시적으로-어떤-컬럼값으로-연결되는지-확인할-수-있다">#</a></h3>
<p>그 다음은 코드의 가독성이 있을 수 있다.</p>
<p>사실 어떤 테이블이건 간에 관계 에 대한 문제는 관계 유형에 따라 달라진다.</p>
<p>상속이라는 문제도 <code>1:1</code> 관계 매핑에 해당되는 문제이기 때문이다.</p>
<p>그렇기에 실제로 판별자를 매번 매핑할 필욘 없겠지만, 우리가 코드를 읽을 때, <strong>아, 이 컬럼을 바탕으로 두 테이블 사이에는 상속 관계가 있구나!</strong> 정도는 확인하고 넘어갈 수 있다.</p>
<h3 id="구분자-컬럼을-정의할-필요가-없다">구분자 컬럼을 정의할 필요가 없다.<a hidden class="anchor" aria-hidden="true" href="#구분자-컬럼을-정의할-필요가-없다">#</a></h3>
<p>구분자 컬럼을 정의할 필요가 없어서 데이터의 무결성을 지키는 데에 도움이 된다.</p>
<p>이게 무슨 뜻이냐? 만약에 <code>order_id</code> 라는 구분자로 처리되고, 우리는 이를 <code>JPA</code> 에게 상속을 통해 맡기고 싶은 상황이 된다고 해보자.</p>
<p>이때, 우리는 <code>@DiscriminatorColumn</code> 으로 구분자 컬럼을 정의해주면, 실제 Entity 필드로 해당 컬럼을 정의할 필요가 없어지게 된다. <strong>컬럼의 이름을 넘겨줌으로써 JPA에게 책임이 넘어가기 때문이다.</strong></p>
<p>그렇기에 해당 필드변수가 Spring Boot 코드 내에서 조작될 일이 없어지므로 해당 연결에 대한 데이터 무결성은 보장된다.</p>
<h3 id="결론">결론<a hidden class="anchor" aria-hidden="true" href="#결론">#</a></h3>
<p>테이블 JOIN을 하는 경우와 테이블별로 그냥 따로 만들 때에는 DiscriminatorColumn은 필수가 아니며,</p>
<p>Inheritance를 통해 서로 다른 테이블(TABLE_PER_CLASS)인 경우에도 하위타입인 것처럼 자바 코드에서 사용할 수 있다!</p>


    </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.blu3fishez.org/tags/spring/">Spring</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.blu3fishez.org/posts/2025/2025-02-07-spring-jpa-converter-%EB%8A%94-%EC%96%B8%EC%A0%9C-%EC%8D%A8%EC%95%BC%ED%95%98%EB%8A%94%EA%B0%80/">
    <span class="title">« Prev</span>
    <br>
    <span>[Spring JPA] Converter 는 언제 써야하는가</span>
  </a>
  <a class="next" href="https://blog.blu3fishez.org/posts/2025/2025-01-31-spring-jpa%EC%97%90-%EB%8C%80%ED%95%B4-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90/">
    <span class="title">Next »</span>
    <br>
    <span>[Spring JPA] JPA에 대해 알아보자</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://github.com/blu3fishez">blu3fishez</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
